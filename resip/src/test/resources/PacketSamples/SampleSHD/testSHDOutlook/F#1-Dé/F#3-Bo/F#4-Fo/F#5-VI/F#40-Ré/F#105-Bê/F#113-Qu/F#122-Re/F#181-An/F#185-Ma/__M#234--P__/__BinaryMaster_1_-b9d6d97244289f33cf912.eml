Return-Path: admtlvitam@gmail.com
Received:  from 213.32.79.242 ([213.32.79.242])        by smtp.gmail.com with
 ESMTPSA id 14sm22721199wmk.1.2016.12.20.07.41.14        for
 <thierry.casimirius@intradef.gouv.fr>        (version=TLS1_2
 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);        Tue, 20 Dec 2016
 07:41:14 -0800 (PST)
Date: Tue, 20 Dec 2016 16:41:17 +0100 (CET)
From: Mantis Bug Tracker <admtlvitam@gmail.com>
To: <thierry.casimirius@intradef.gouv.fr>
Message-ID: <b9d6d97244289f33cf912a27af398275@213.32.79.242>
Subject: [Projet VITAM 0000023]:
 [API-access-external/v1/objects-POST-Override-GET] : httpCode 501 -
 NOT_IMPLEMENTED au lieu de httpcode200
Keywords:  [Projet VITAM] VITAM
MIME-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_325_20730453.1517006384947"
X-Google-DKIM-Signature:  v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:date:to:from:subject:message-id:auto-submitted
         :keywords:mime-version:content-transfer-encoding;
        bh=EJ17I6k0MaE3Gqc4fsAV6R7w88Q6BTS/RkQNXg8EItQ=;
        b=FQYjXH+jVxz3JfrJP5DySZfGom9o4JljKBSi7rJd3nYb18B9+hKtj7hPk4/t+DBQyr
         wjk0v4c6Io6DVTJ/glandtf6tGsjibjuJw2+XkVUy3FsOP6U3zn72HVeIim9lIP3hj/h
         sPYl/FHN/Q/OZYxkGiDPSbWAKTeDm5FuH9CQxa9D84eSOaBJMPpXLeg4UFpNomkR6z2I
         rR7ET4H0hQP04a5kI1/wYjowKR47jU2EYl5fpEpLejrfB30st510kc8r5UF2KvY+Absk
         WZMJN5gT4wE7T7OMSAmanE9gmKVTgPHbL3FSxYi9fPM85wEKZ1sj1csKjdduv+Ngu0dD
         O33Q==
X-Gm-Message-State:  AIkVDXKo6XryiRYtwWSl+KfINPsHKJKy3usG4c4vl4doA4xuA6L4T4ZbAgNt7p2fnyeNMQ==
X-Received:  by 10.28.131.1 with SMTP id f1mr2606210wmd.43.1482248474874;
        Tue, 20 Dec 2016 07:41:14 -0800 (PST)
X-Priority:  3
X-Mailer:  PHPMailer 5.2.15 (https://github.com/PHPMailer/PHPMailer)
Auto-Submitted:  auto-generated
X-Auto-Response-Suppress:  All
X-PMX-Version:  6.3.1.2588712, Antispam-Engine: 2.7.2.2107409, Antispam-Data: 2016.12.20.153316
X-PMX-Spam:  Gauge=IIIIIIII, Probability=8%, Report='
 HTML_00_01 0.05, HTML_00_10 0.05, DKIM_SIGNATURE 0, FROM_NAME_PHRASE 0, IP_HTTP_ADDR 0, IP_HTTP_ADDR_WITH_PORT 0, SPF_PASS 0, URI_ENDS_IN_PHP 0, WEBMAIL_SOURCE 0, WEBMAIL_XMAILER 0, __ANY_URI 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __DQ_NEG_HEUR 0, __DQ_NEG_IP 0, __FRAUD_MONEY 0, __FRAUD_MONEY_CURRENCY 0, __FRAUD_MONEY_CURRENCY_DOLLAR 0, __FRAUD_MONEY_DENOMINATION 0, __FRAUD_MONEY_VALUE 0, __FRAUD_WEBMAIL 0, __FRAUD_WEBMAIL_FROM 0, __FROM_GMAIL 0, __HAS_FROM 0, __HAS_MSGID 0, __HAS_X_MAILER 0, __HAS_X_PRIORITY 0, __HELO_GMAIL 0, __HIGHBITS 0, __HTTPS_URI 0, __MIME_TEXT_ONLY 0, __MIME_TEXT_P 0, __MIME_TEXT_P1 0, __MIME_VERSION 0, __MSGID_32HEX 0, __MULTIPLE_URI_TEXT 0, __NO_HTML_TAG_RAW 0, __PHISH_SPEAR_STRUCTURE_1 0, __RDNS_GMAIL 0, __SANE_MSGID 0, __STOCK_PHRASE_24 0, __TO_MALFORMED_2 0, __TO_NO_NAME 0, __URI_IN_BODY 0, __URI_NO_MAILTO 0, __URI_NO_WWW 0,
 __URI_WITH_PATH 0, __YOUTUBE_RCVD 0'
x-msw-original-dkim-signature:  v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=date:to:from:subject:message-id:auto-submitted:keywords
         :mime-version:content-transfer-encoding;
        bh=EJ17I6k0MaE3Gqc4fsAV6R7w88Q6BTS/RkQNXg8EItQ=;
        b=PZAaGvXF+ucs2MTKChWz2f1WFXVFmck2OB3/beDXnxi7vkfItJQGfGW/1qbCfv0ICc
         tGk755BPK8Zp/gQu8TKtfGIA4wqYAkYDgyFu1b/KvsVbtoS1pncHBcEdOTfve6F7NLxt
         2yhfIB333GXjsotvBAVBdu+G5JFPtYGX9V3lIguL59KSpl+XZzZN7aqcR/WWfLDRWM+9
         1mrsBnX5zD1ibMX2sTEUVVBu/PXPBUUBOch8RON9h5irBAusN/+pVjBFFU2X73EBgW4h
         X7qYmLgCpzVqKH+HlJk2ryRZIfBMbSYjl08qk8k8eIqA2RofKxSGlaaasLuyBSwI52yb
         hBqw==
x-msw-jemd-spam:  unknown
x-msw-jemd-refid:  [1]50,0,0,,d41d8cd98f00b204,admtlvitam@gmail.com,thierry.casimirius@intradef.gouv.fr,RULES_HIT:1:2:41:152:355:371:372:379:541:543:836:882:901:960:967:973:982:988:1260:1261:1263:1277:1311:1313:1314:1345:1381:1437:1513:1515:1516:1518:1521:1593:1594:1605:1730:1747:1777:1792:1801:2198:2199:2393:2525:2565:2682:2685:2859:2892:2901:2933:2937:2939:2942:2945:2947:2951:2954:3022:3138:3139:3140:3141:3142:3876:3877:3934:3936:3938:3941:3944:3947:3950:3953:3956:3959:4051:4250:4321:4605:5007:6114:6119:6261:6642:6653:6996:6997:7688:7875:7903:8599:8603:8784:8808:8957:8985:8987:9025:9075:9121:9388:9413:10004:10049:10849:11026:11233:11473:11658:11783:12043:12109:12114:12291:12438:12517:12519:12555:12663:12679:12683:12740:13018:13019:13025:13191:13192:13206:13229:13255:13870:14110:14687:21063:21064:21080:21433:21444:30012:30045:30054:30075:30080,0,RBL:74.125.82.51:@gmail.com:thierry.casimirius@intradef.gouv.fr
X-MS-Exchange-Organization-AVStamp-Mailbox:  SMEXw]nP;1310500;0;This mail has
 been scanned by Trend Micro ScanMail for Microsoft Exchange;
X-MS-Exchange-Organization-SCL:  0
X-MS-Exchange-Organization-AuthSource: 
 MVLINF10CTNWM02.DR-RES.INTRADEF.GOUV.FR
X-MS-Exchange-Organization-AuthAs:  Anonymous

------=_Part_325_20730453.1517006384947
Content-Type: multipart/alternative; 
	boundary="----=_Part_326_18289395.1517006384947"

------=_Part_326_18289395.1517006384947
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

Le bogue suivant a =C3=A9t=C3=A9 soumis.=20
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=20
http://213.32.79.242/mantisbt/view.php?id=3D23=20
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=20
Rapporteur:                 Omar
Responsable:                Omar
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=20
Projet:                     Projet VITAM
Bogue ID:                   23
Cat=C3=A9gorie:                  VITAM
Reproductibilit=C3=A9:           toujours
Impact:                     bloquant
Priorit=C3=A9:                   imm=C3=A9diate
Statut:                     affect=C3=A9
Comportement attendu:       =20
US concern=C3=A9e:               =20
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=20
Date de soumission:         2016-12-20 16:41 CET
Derni=C3=A8re modification:      2016-12-20 16:41 CET
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=20
R=C3=A9sum=C3=A9:                     [API-access-external/v1/objects-POST-=
Override-GET]
: httpCode 501 - NOT_IMPLEMENTED au lieu de httpcode200
Description:=20
On indique dans la documentation
<serveur>/doc/raml/externe/access.html#objects_post, que cette collection
accepte la m=C3=A9thode POST telle qu'on le fait ci dessous (avec ou X-Qual=
ifier:
BinaryMaster). Par contre pour nous le r=C3=A9sultat est le m=C3=AAme, nous=
 obtenons un
code HTTP/1.1 501 Not Implemented

Voici la reqqu=C3=AAte que nous soumettons via SOAPUI


POST https://213.32.79.242:8444/access-external/v1/objects HTTP/1.1
X-Qualifier: BinaryMaster
X-Http-Method-Override: GET
Accept: application/json
Content-Type: application/json
Content-Length: 72
Host: 213.32.79.242:8444
Connection: Keep-Alive
User-Agent: Apache-HttpClient/4.1.1 (java 1.5)

{
  "$roots": [],
  "$query": [],
  "$filter": {},
  "$projection": {}
}


cette requ=C3=AAte renvoie, la r=C3=A9ponse ci dessous

{
   "httpCode": 501,
   "code": "NOT_IMPLEMENTED",
   "context": "ACCESS_EXTERNAL",
   "state": "code_vitam",
   "message": "Not Implemented",
   "description": "Not Implemented",
   "errors": []
}


Pour information, via la version Alpha (bouchon) =3D> en postant la requ=C3=
=AAte
suivante:
POST http://127.0.0.1:8082/external/v1/objects HTTP/1.1
X-Qualifier: BinaryMaster
X-Http-Method-Override: GET
Content-Type: application/json
Accept: application/json
Content-Length: 75
Host: 127.0.0.1:8082
Connection: Keep-Alive
User-Agent: Apache-HttpClient/4.1.1 (java 1.5)

{
  "$roots": [ ],
  "$query": [ ],
  "$filter": {},
  "$projection": { }
}


le retour est le suivant:

{
   "$hits":    {
      "total": 3,
      "size": 3,
      "offset": 0,
      "limit": 100,
      "time_out": false
   },
   "$context":    {
      "$roots": [],
      "$query": [],
      "$filter": {},
      "$projection": {}
   },
   "$results":    [
            {
         "#id": "id101",
         "#type": "Document",
         "#qualifiers":          {
            "BinaryMaster": 5,
            "Thumbnail": 1,
            "Dissemination": 1,
            "TextContent": 1
         },
         "#parents": [         {
            "#id": "id1",
            "#type": "DemandeCong=C3=A9s",
            "#sector": "RessourcesHumaines"
         }]
      },
            {
         "#id": "id102",
         "#type": "Document",
         "#qualifiers":          {
            "BinaryMaster": 5,
            "Thumbnail": 1,
            "Dissemination": 1,
            "TextContent": 1
         },
         "#parents": [         {
            "#id": "id2",
            "#type": "DemandeCong=C3=A9s",
            "#sector": "RessourcesHumaines"
         }]
      },
            {
         "#id": "id103",
         "#type": "Document",
         "#qualifiers":          {
            "BinaryMaster": 3,
            "Thumbnail": 1,
            "Dissemination": 1,
            "TextContent": 1
         },
         "#parents": [         {
            "#id": "id3",
            "#type": "DemandeCong=C3=A9s",
            "#sector": "RessourcesHumaines"
         }]
      }
   ]
}




Pour information sur Vitam Beta, le post-override get sur la collection
access-external/v1/objects/{idu} fonctionne, cf ci dessous

POST
https://213.32.79.242:8444/access-external/v1/objects/aeaaaaaaaaaam7mxabmk4=
akzdo5kbtqaaaba
HTTP/1.1
X-Http-Method-Override: GET
Accept: application/json
Content-Type: application/json
Content-Length: 72
Host: 213.32.79.242:8444
Connection: Keep-Alive
User-Agent: Apache-HttpClient/4.1.1 (java 1.5)

{
  "$roots": [],
  "$query": [],
  "$filter": {},
  "$projection": {}
}



r=C3=A9ponse sur Beta

{
   "$hits":    {
      "total": 1,
      "offset": 0,
      "limit": 1,
      "size": 1
   },
   "$results": [   {
      "FileInfo":       {
         "Filename": "SHDMC_REP_1A_V2009.pdf",
         "LastModified": "2015-11-10T12:12:30.000+01:00"
      },
      "#id": "aeaaaaaaaaaam7mxabmk4akzdo5kbtqaaaba",
      "#nbobjects": 0,
      "#qualifiers":       {
         "BinaryMaster":          {
            "_nbc": 1,
            "versions": [            {
               "_id": "aeaaaaaaaaaam7mxabmk4akzdo5kbtqaaaaq",
               "DataObjectGroupId": "aeaaaaaaaaaam7mxabmk4akzdo5kbtqaaaba",
               "DataObjectVersion": "BinaryMaster_1",
               "FormatIdentification":                {
                  "FormatLitteral": "Acrobat PDF 1.4 - Portable Document
Format",
                  "MimeType": "application/pdf",
                  "FormatId": "fmt/18"
               },
               "FileInfo":                {
                  "Filename": "SHDMC_REP_1A_V2009.pdf",
                  "LastModified": "2015-11-10T12:12:30.000+01:00"
               },
               "Size": 102887,
               "Uri": "Content/ID5.pdf",
               "MessageDigest":
"eb43f029e26ce2e4f5660e095db7efd4b924adbaf7b8966a765b595958c5b0a10e2c6fd7a5=
714634b3cc673d3da249284339a88bff89ccdfd2ea7d4821d79b86",
               "Algorithm": "SHA-512"
            }]
         },
         "Thumbnail":          {
            "_nbc": 1,
            "versions": [            {
               "_id": "aeaaaaaaaaaam7mxabmk4akzdo5kb3aaaaaq",
               "DataObjectGroupId": "aeaaaaaaaaaam7mxabmk4akzdo5kbtqaaaba",
               "DataObjectVersion": "Thumbnail_1",
               "FormatIdentification":                {
                  "FormatLitteral": "Microsoft Excel for Windows",
                  "MimeType":
"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                  "FormatId": "fmt/214"
               },
               "FileInfo":                {
                  "Filename": "SHDMC_REP_1A_V2009.xlsx",
                  "LastModified": "2016-12-13T16:04:50.492+01:00"
               },
               "Size": 8414,
               "Uri": "Content/ID9.xlsx",
               "MessageDigest":
"65b217aedf5be57d023af92c48cbe40b53ee03874634a258a911209e34c5981bc6815a1e45=
e73f01ed87c4fe998c873665b9296a5ffa4d4555481e47e1d91db6",
               "Algorithm": "SHA-512"
            }]
         }
      },
      "#type": "",
      "#tenant": 0,
      "#unitups": ["aeaaaaaaaaaam7mxabmk4akzdo5kb3yaaaaq"],
      "#operations": ["aedqaaaaacaam7mxabpvoakzdo5ijtiaaaaq"]
   }],
   "$context":    {
      "$roots": [],
      "$query": [],
      "$filter": {},
      "$projection": {}
   }
}




=C3=89tapes pour le reproduire:=20
poster une des requ=C3=AAtes indiqu=C3=A9es dans Description

Informations compl=C3=A9mentaires:=20
La version alpha utilis=C3=A9e est celle sur le site api vitam
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=20

Historique du bogue=20
Date de modificationNom d=E2=80=99utilisateurChamp                    Chang=
ement     =20
   =20
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=20
2016-12-20 16:41 Omar           Nouveau bogue                              =
 =20
2016-12-20 16:41 Omar           Statut                   nouveau =3D> affec=
t=C3=A9 =20
2016-12-20 16:41 Omar           Assign=C3=A9 =C3=A0                 =3D> Om=
ar           =20
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
------=_Part_326_18289395.1517006384947--

------=_Part_325_20730453.1517006384947--
