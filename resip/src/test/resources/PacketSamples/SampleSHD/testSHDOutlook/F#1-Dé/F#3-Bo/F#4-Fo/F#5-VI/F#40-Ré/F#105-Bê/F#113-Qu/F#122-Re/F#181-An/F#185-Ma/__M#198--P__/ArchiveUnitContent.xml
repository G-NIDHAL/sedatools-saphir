<Content>
    <DescriptionLevel>Item</DescriptionLevel>
    <Title>[Projet VITAM 0000060]: [API-/access-access-external/v1/objects/{ido}] :Retour avec &quot;httpCode&quot;: 406, &quot;message&quot;: &quot;HTTP 406 Not Acceptable&quot; au lieu de 200</Title>
    <OriginatingSystemId>&lt;dae6b93e86caecbc92db10185ef093cd@213.32.79.242&gt;</OriginatingSystemId>
    <Writer>
        <FirstName>Mantis Bug Tracker</FirstName>
        <BirthName>Mantis Bug Tracker</BirthName>
        <Identifier>admtlvitam@gmail.com</Identifier>
    </Writer>
    <Addressee>
        <FirstName>thierry.casimirius</FirstName>
        <BirthName>thierry.casimirius</BirthName>
        <Identifier>thierry.casimirius@intradef.gouv.fr</Identifier>
    </Addressee>
    <SentDate>2017-01-09T15:07:32Z</SentDate>
    <ReceivedDate>2017-01-09T15:07:40Z</ReceivedDate>
    <TextContent>Le bogue suivant a été soumis. 
====================================================================== 
http://213.32.79.242/mantisbt/view.php?id=60 
====================================================================== 
Rapporteur:                 Omar
Responsable:                Omar
====================================================================== 
Projet:                     Projet VITAM
Bogue ID:                   60
Catégorie:                  BugFromTestlink
Reproductibilité:           toujours
Impact:                     majeur
Priorité:                   élevée
Statut:                     affecté
Comportement attendu:        
US concernée:                
====================================================================== 
Date de soumission:         2017-01-09 16:07 CET
Dernière modification:      2017-01-09 16:07 CET
====================================================================== 
Résumé:                     [API-/access-access-external/v1/objects/{ido}]
:Retour avec &quot;httpCode&quot;: 406, &quot;message&quot;: &quot;HTTP 406 Not Acceptable&quot; au lieu de
200
Description: 
Lorsque l&apos;on soumet une requête pour obtenir un fichier appartenant à un GOT
via la collection access/obects/{ido}, l&apos;API retourne un httpCode 406 quelque
soit le qualifier Dissemination, Thumbnail ou TextContent (ie fichier du GOT).
On joint le SIP avec ATR OK pour qui le téléchargement ainsi l&apos;affichage des
objets est ok via IHM. 

A noter que le POST avec dans le Header  Accept=application/json, fonctionne, cf
ci dessous la requête envoyé et la réponse obtenue
Requête envoyée

POST
https://213.32.79.242:8444/access-external/v1/objects/aeaaaaaaaaaam7mxaayieakzqoenaqiaaaaq
HTTP/1.1
X-Http-Method-Override: GET
Accept: application/json
Content-Type: application/json
Content-Length: 72
Host: 213.32.79.242:8444
Connection: Keep-Alive
User-Agent: Apache-HttpClient/4.1.1 (java 1.5)

Réponse obtenue avec Accept=Application/json
{
   &quot;$hits&quot;:    {
      &quot;total&quot;: 1,
      &quot;offset&quot;: 0,
      &quot;limit&quot;: 1,
      &quot;size&quot;: 1
   },
   &quot;$results&quot;: [   {
      &quot;FileInfo&quot;:       {
         &quot;Filename&quot;: &quot;vitam_-_modele_de_workflow.pdf&quot;,
         &quot;LastModified&quot;: &quot;2017-01-02T10:44:04.893+01:00&quot;
      },
      &quot;#id&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenaqiaaaaq&quot;,
      &quot;#nbobjects&quot;: 0,
      &quot;#qualifiers&quot;:       {
         &quot;BinaryMaster&quot;:          {
            &quot;_nbc&quot;: 1,
            &quot;versions&quot;: [            {
               &quot;_id&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenapyaaaaq&quot;,
               &quot;DataObjectGroupId&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenaqiaaaaq&quot;,
               &quot;DataObjectVersion&quot;: &quot;BinaryMaster_1&quot;,
               &quot;FormatIdentification&quot;:                {
                  &quot;FormatLitteral&quot;: &quot;Acrobat PDF 1.5 - Portable Document
Format&quot;,
                  &quot;MimeType&quot;: &quot;application/pdf&quot;,
                  &quot;FormatId&quot;: &quot;fmt/19&quot;
               },
               &quot;FileInfo&quot;:                {
                  &quot;Filename&quot;: &quot;vitam_-_modele_de_workflow.pdf&quot;,
                  &quot;LastModified&quot;: &quot;2017-01-02T10:44:04.893+01:00&quot;
               },
               &quot;Size&quot;: 1066218,
               &quot;Uri&quot;: &quot;Content/ID5.pdf&quot;,
               &quot;MessageDigest&quot;:
&quot;0207ce2192c32d771abf8662afce53b0bee7381a033346409637fa41a918cec99a4a9f4558aa7c2805600203d8e701fd8eed71be4846f194b79800b4770e2287&quot;,
               &quot;Algorithm&quot;: &quot;SHA-512&quot;
            }]
         },
         &quot;Dissemination&quot;:          {
            &quot;_nbc&quot;: 1,
            &quot;versions&quot;: [            {
               &quot;_id&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenbwaaaaaq&quot;,
               &quot;DataObjectGroupId&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenaqiaaaaq&quot;,
               &quot;DataObjectVersion&quot;: &quot;Dissemination_1&quot;,
               &quot;FormatIdentification&quot;:                {
                  &quot;FormatLitteral&quot;: &quot;Acrobat PDF 1.5 - Portable Document
Format&quot;,
                  &quot;MimeType&quot;: &quot;application/pdf&quot;,
                  &quot;FormatId&quot;: &quot;fmt/19&quot;
               },
               &quot;FileInfo&quot;:                {
                  &quot;Filename&quot;: &quot;vitam_-_scenarios_de_test.pdf&quot;,
                  &quot;LastModified&quot;: &quot;2017-01-02T10:44:05.610+01:00&quot;
               },
               &quot;Size&quot;: 212295,
               &quot;Uri&quot;: &quot;Content/ID13.pdf&quot;,
               &quot;MessageDigest&quot;:
&quot;74bc122c6924e16ccf9232c51a6752f0964897253dbb50bb011ddafc103db5b2602c7fc0faadac76e71f460fd4b5f86b44b44430dc57d7e059b09536ea2b0a7d&quot;,
               &quot;Algorithm&quot;: &quot;SHA-512&quot;
            }]
         },
         &quot;TextContent&quot;:          {
            &quot;_nbc&quot;: 1,
            &quot;versions&quot;: [            {
               &quot;_id&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenbvaaaaaq&quot;,
               &quot;DataObjectGroupId&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenaqiaaaaq&quot;,
               &quot;DataObjectVersion&quot;: &quot;TextContent_1&quot;,
               &quot;FormatIdentification&quot;:                {
                  &quot;FormatLitteral&quot;: &quot;Acrobat PDF/A - Portable Document Format&quot;,
                  &quot;MimeType&quot;: &quot;application/pdf&quot;,
                  &quot;FormatId&quot;: &quot;fmt/95&quot;
               },
               &quot;FileInfo&quot;:                {
                  &quot;Filename&quot;:
&quot;vitam_-_organisation_de_linformation_2016-11-29_17-39-38_110.pdf&quot;,
                  &quot;LastModified&quot;: &quot;2017-01-02T10:44:05.767+01:00&quot;
               },
               &quot;Size&quot;: 1149256,
               &quot;Uri&quot;: &quot;Content/ID9.pdf&quot;,
               &quot;MessageDigest&quot;:
&quot;234e8564a44fc3729e88618f010d6addcf1e97fbaafd82d440655f6b020ec7a4f98e59c636a64d205ee7f6f6e8c388b49fcb1d474e1a458e0d9ec996a5cef991&quot;,
               &quot;Algorithm&quot;: &quot;SHA-512&quot;
            }]
         },
         &quot;Thumbnail&quot;:          {
            &quot;_nbc&quot;: 1,
            &quot;versions&quot;: [            {
               &quot;_id&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenbwyaaaaq&quot;,
               &quot;DataObjectGroupId&quot;: &quot;aeaaaaaaaaaam7mxaayieakzqoenaqiaaaaq&quot;,
               &quot;DataObjectVersion&quot;: &quot;Thumbnail_1&quot;,
               &quot;FormatIdentification&quot;:                {
                  &quot;FormatLitteral&quot;: &quot;Acrobat PDF/A - Portable Document Format&quot;,
                  &quot;MimeType&quot;: &quot;application/pdf&quot;,
                  &quot;FormatId&quot;: &quot;fmt/95&quot;
               },
               &quot;FileInfo&quot;:                {
                  &quot;Filename&quot;:
&quot;vitam_-_structuration_des_submission_information_package_sip.pdf&quot;,
                  &quot;LastModified&quot;: &quot;2017-01-02T10:44:04.969+01:00&quot;
               },
               &quot;Size&quot;: 799691,
               &quot;Uri&quot;: &quot;Content/ID17.pdf&quot;,
               &quot;MessageDigest&quot;:
&quot;638fed05381e9c17213d9ff3ae8362b9fb5db6270cf696fefe474297a03622e735122f6aa5ed341ea4deab499b419cb3b1149211d7d44c666923fb1a0234baf8&quot;,
               &quot;Algorithm&quot;: &quot;SHA-512&quot;
            }]
         }
      },
      &quot;#type&quot;: &quot;&quot;,
      &quot;#tenant&quot;: 0,
      &quot;#unitups&quot;: [&quot;aeaaaaaaaaaam7mxaayieakzqoenbxqaaaaq&quot;],
      &quot;#operations&quot;: [&quot;aedqaaaaacaam7mxaba7uakzqoekqhyaaaaq&quot;]
   }],
   &quot;$context&quot;:    {
      &quot;$roots&quot;: [],
      &quot;$query&quot;: [],
      &quot;$filter&quot;: {},
      &quot;$projection&quot;: {}
   }
}

Étapes pour le reproduire: 
Intégrer le SIP JOINT SIP-20170109145552.zip
Aller sur l&apos;IHM et récupérer les id des objets
aller sur SOAP UI et solliciter les API avec les ID correspondants sur les
requêtes suivantes
PVI-721:Télécharger un fichier 1 appartenant à un GOT via API
PVI-722:Télécharger un fichier 2 appartenant à un GOT via API
PVI-723:Télécharger un fichier 3 appartenant à un GOT via API

exemple 
POST
https://213.32.79.242:8444/access-external/v1/objects/aeaaaaaaaaaam7mxaayieakzqoenaqiaaaaq
HTTP/1.1
X-Http-Method-Override: GET
Content-Type: application/json
Accept: application/zip
Content-Length: 72
Host: 213.32.79.242:8444
Connection: Keep-Alive
User-Agent: Apache-HttpClient/4.1.1 (java 1.5)

{
  &quot;$roots&quot;: [],
  &quot;$query&quot;: [],
  &quot;$filter&quot;: {},
  &quot;$projection&quot;: {}
}


====================================================================== 

Historique du bogue 
Date de modificationNom d’utilisateurChamp                    Changement      
    
====================================================================== 
2017-01-09 16:07 Omar           Nouveau bogue                                
2017-01-09 16:07 Omar           Statut                   nouveau =&gt; affecté  
2017-01-09 16:07 Omar           Assigné à                 =&gt; Omar            
2017-01-09 16:07 Omar           Fichier ajouté:
ATR_aedqaaaaacaam7mxaba7uakzqoekqhyaaaaq.xml                    
======================================================================</TextContent>
</Content>